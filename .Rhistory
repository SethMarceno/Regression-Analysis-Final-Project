m1 <- update(baseModel, fullModel)
backwards <- step(m1, scope = c(lower = ~ X1) , direction = 'backward')
data(mantel)
X1 <- mantel$X1
X2 <- mantel$X2
X3 <- mantel$X3
Y <- mantel$Y
fullModel <- ~ X1 + X2 + X3
baseModel <- lm(Y ~ X1)
forward <- step(baseModel, fullModel, direction = 'forward')
forward <- step(baseModel, fullModel, direction = 'forward', k = log(n))
forward <- step(baseModel, fullModel, direction = 'forward', k = log(length(X1)))
forward <- step(m1, scope = c(lower = ~ X1), direction = 'backward', k = log(length(X1)), trace = 0)
forwardBIC <- step(baseModel, fullModel, direction = 'forward', k = log(length(X1)), trace = 0)
backwardBIC <- step(m1, scope = c(lower = ~ X1), direction = 'backward', k = log(length(X1)), trace = 0)
forwardBIC <- step(baseModel, fullModel, direction = 'forward', k = log(length(X1)))
backwardBIC <- step(m1, scope = c(lower = ~ X1), direction = 'backward', k = log(length(X1)))
save.image('HW7.RData')
RealEstate <- read.csv('RealEstateValuation.txt')
View(RealEstate)
View(RealEstate)
RealEstate <- read.table('RealEstateValuation.txt')
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
library("alr4", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
library("faraway", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
fit1 <- lm(Price ~ TDate + Age + Stores + Latitude)
scatterplotMatrix(fit1)
scatterplotMatrix(formula = fit1)
scatterplotMatrix(fit1, formula = fit1)
scatterplotMatrix(~ TDate + Age + Stores + Latitude)
fit1 <- lm(Price ~ TDate + Age + Stores + Latitude)
summary(fit1)
scatterplotMatrix(~Price + TDate + Age + Stores + Latitude)
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
Metro <- RealEstate$Metro
Longitude <- RealEstate$Longitude
full.lm <- ~ TDate + Age + Stores + Latitude + Metro + Longitude
step(fit1, full.lm, direction = 'forward')
full2.lm <- ~ TDate + Age + Stores + Latitude + Longitude + Metro
step(fit1, full2.lm, direction = 'forward')
metro.fit <- lm(Price ~ TDate + Age + Stores + Latitude + Metro)
anova(fit1, metro.fit)
longitude.fit <- lm(Price ~ TDate + Age + Stores + Latitude + Longitude)
anova(fit1, metro.fit)
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
Metro <- RealEstate$Metro
Longitude <- RealEstate$Longitude
scatterplotMatrix(~Price + TDate + Age + Stores + Latitude)
fit1 <- lm(Price ~ TDate + Age + Stores + Latitude)
summary(fit1)
fit1 <- lm(Price ~ TDate + Age + Stores + Latitude)
summary(fit1)
fit2 <- lm(Price ~ TDate + Age + Stores + Latitude + Longitude)
summary(fit2)
fit3 <- lm(Price ~ TDate + Age + Stores + Latitude + Metro)
summary(fit3)
fit4 <- lm(Price ~ TDate + Age + Stores + Latitude + Metro + Longitude + Longitude:Metro)
summary(fit4)
save.image('FinalProject.RData')
library("data.table", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
fit5 <- lm(Price âˆ¼ TDate + Age + Metro + Latitude)
fit5 <- lm(Price ~ TDate + Age + Metro + Latitude)
fit5 <- lm(Price ~ TDate + Age + Metro + Latitude)
anova(fit1, fit5)
fit5 <- lm(Price ~ TDate + Age + Metro + Latitude)
anova(fit5, fit1)
fit5 <- lm(Price ~ TDate + Age + Metro + Latitude)
anova(fit1, fit5)
fit5 <- lm(Price ~ TDate + Age + Metro + Latitude)
summary(fit1)
summary(fit5)
View(RealEstate)
View(RealEstate)
View(RealEstate)
View(RealEstate)
RealEstate$Age <- with(RealEstate, (Age + 1))
View(RealEstate)
View(RealEstate)
RealEstate$Age <- with(RealEstate, (Age + 1))
RealEstate$Stores <- with(RealEstate, (Stores + 1))
RealEstate$Age <- with(RealEstate, (Age + 1))
RealEstate$Stores <- with(RealEstate, (Stores + 1))
RE.pt <- powerTransform(cbind(TDate, Age, Metro, Latitude) ~ 1, RealEstate)
summary(RE.pt)
View(RealEstate)
View(RealEstate)
RealEstate$Age <- with(RealEstate, (Age + 1))
RealEstate$Stores <- with(RealEstate, (Stores + 1))
RE.pt <- powerTransform(cbind(TDate, Age, Metro, Latitude) ~ 1, RealEstate)
summary(RE.pt)
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
Metro <- RealEstate$Metro
Longitude <- RealEstate$Longitude
RealEstate$Age <- with(RealEstate, (Age + 1))
RealEstate$Stores <- with(RealEstate, (Stores + 1))
RE.pt <- powerTransform(cbind(TDate, Age, Metro, Latitude) ~ 1, RealEstate)
summary(RE.pt)
testTransform(RE.pt, lambda = c(1, 0.5, 0, 1))
RE.pt <- powerTransform(cbind(TDate, Age, Metro, Latitude) ~ 1, RealEstate)
summary(RE.pt)
#testTransform(RE.pt, lambda = c(1, 0.5, 0, 1))
testTransform(RE.pt, lambda = c(1, 1, 1, 1))
RealEstate <- read.table('RealEstateValuation.txt')
Price <- RealEstate$Price
TDate <- RealEstate$TDate
Age <- RealEstate$Age
Stores <- RealEstate$Stores
Latitude <- RealEstate$Latitude
Metro <- RealEstate$Metro
Longitude <- RealEstate$Longitude
RealEstate$Age <- with(RealEstate, (Age + 1))
RE.pt <- powerTransform(cbind(TDate, Age, Metro, Latitude) ~ 1, RealEstate)
summary(RE.pt)
#testTransform(RE.pt, lambda = c(1, 0.5, 0, 1))
testTransform(RE.pt, lambda = c(1, 0.5, 1, 1))
#testTransform(RE.pt, lambda = c(1, 0.5, 0, 1))
testTransform(RE.pt, lambda = c(1, 0.5, 0, 1))
RE_trsf = with(RealEstate, data.frame(TDate, I(Age^0.5), log(Metro), Latitude))
RE_trsf = with(RealEstate, data.frame(TDate, I(Age^0.5), log(Metro), Latitude))
pairs(RE_trsf)
RE_trsf = with(RealEstate, data.frame(Price, TDate, I(Age^0.5), log(Metro), Latitude))
pairs(RE_trsf)
sqrt(4)
sqrt_Age <- sqrt(Age)
RE_trsf = with(RealEstate, data.frame(Price, TDate, sqrt(Age), log(Metro), Latitude))
pairs(RE_trsf)
boxCox(fit5)
final.fit <- lm(log(Price) ~ TDate  + sqrt(Age) + log(Metro) + Latitude)
final.fit <- lm(log(Price) ~ TDate  + sqrt(Age) + log(Metro) + Latitude)
summary(final.fit)
save.image('FinalProject.RData')
load('HW7.RData')
library("alr4", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
library("faraway", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
data(lathe1)
data(mantel)
X1 <- mantel$X1
X2 <- mantel$X2
X3 <- mantel$X3
Y <- mantel$Y
fullModel <- ~ X1 + X2 + X3
baseModel <- lm(Y ~ 1)
forward <- step(baseModel, fullModel, direction = 'forward')
data(mantel)
X1 <- mantel$X1
X2 <- mantel$X2
X3 <- mantel$X3
Y <- mantel$Y
fullModel <- ~ X1 + X2 + X3
baseModel <- lm(Y ~ X1)
forward <- step(baseModel, fullModel, direction = 'forward')
data(lathe1)
Speed <- lathe1$Speed
Feed <- lathe1$Feed
Life <- lathe1$Life
save.image('HW7.RData')
View(lathe1)
data(lathe1)
Speed <- lathe1$Speed
Feed <- lathe1$Feed
Life <- lathe1$Life
fit1 <- lm(Life ~ Speed + Feed)
boxCox()
data(lathe1)
Speed <- lathe1$Speed
Feed <- lathe1$Feed
Life <- lathe1$Life
fit1 <- lm(Life ~ Speed + Feed)
boxCox(fit1)
fit2 <- lm(log(Life) ~ Speed + Feed)
fit2 <- lm(log(Life) ~ Speed + Feed)
plot(Life, Speed, Feed)
fit2 <- lm(log(Life) ~ Speed + Feed)
plot(Life, Speed)
fit2 <- lm(log(Life) ~ Speed + Feed)
plot(Life, Feed)
fit2 <- lm(log(Life) ~ Speed + Feed)
outlierTest(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed)
outlier.Test(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed)
outlier.test(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed)
outlierTest(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed)
outlierTest(fit2, n.max = 2)
data(lathe1)
Speed <- lathe1$Speed
Feed <- lathe1$Feed
Life <- lathe1$Life
fit1 <- lm(Life ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
boxCox(fit1)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
outlierTest(fit2, n.max = 2)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
outlierTest(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed:Feed)
outlierTest(fit2)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
outlierTest(fit2)
View(lathe1)
save.image('HW7.RData')
load('HW7.RData')
predict(fit1)
confint(fit1, type = 'prediction')
load('HW7.RData')
e <- 1
hii <- .9
P <- 4
n <- 54
ri_1 <- e/hii
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
e <- 1
hii <- .9
p <- 4
n <- 54
ri_1 <- e/hii
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*((n-p-1/n-p-((ri_1^2))^2))
ti_1
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*((n-p-1/n-p-((ri_1^2))^2))
ti_1
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*((n-p-1/n-p-((ri_1^2))^0.5))
ti_1
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
e <- 1.732
hii <- 0.75
p <- 4
n <- 54
sigma <- 4
ri_2 <- e/ (sigma*(sqrt(1-hii)))
ri_2
Di_2 <- (1/p)*(ri_2^2)*(hii/(1-hii))
Di_2
ti_2 <- ri_2*(((n-p-1)/(n-p-(ri_2^2)))^0.5)
ti_2
e <- 9
hii <- 0.25
p <- 4
n <- 54
sigma <- 4
ri_3 <- e/ (sigma*(sqrt(1-hii)))
ri_3
Di_3 <- (1/p)*(ri_3^2)*(hii/(1-hii))
Di_3
ti_3 <- ri_1*(((n-p-1)/(n-p-(ri_3^2)))^0.5)
ti_3
e <- 9
hii <- 0.25
p <- 4
n <- 54
sigma <- 4
ri_3 <- e/ (sigma*(sqrt(1-hii)))
ri_3
Di_3 <- (1/p)*(ri_3^2)*(hii/(1-hii))
Di_3
ti_3 <- ri_3*(((n-p-1)/(n-p-(ri_3^2)))^0.5)
ti_3
e <- 10.295
hii <- 0.185
p <- 4
n <- 54
sigma <- 4
ri_4 <- e/ (sigma*(sqrt(1-hii)))
ri_4
Di_4 <- (1/p)*(ri_4^2)*(hii/(1-hii))
Di_4
ti_4 <- ri_4*(((n-p-1)/(n-p-(ri_4^2)))^0.5)
ti_4
library("alr4", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
library("faraway", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
qt(p = 97.5, df = 49, lower.tail = FALSE)
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
qt(p = 0.975, df = 49, lower.tail = FALSE)
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
qt(p = 0.95, df = 49, lower.tail = FALSE)
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
qt(p = 0.95, df = 49, lower.tail = TRUE)
e <- 1
hii <- .9
p <- 4
n <- 54
sigma <- 4
ri_1 <- e/ (sigma*(sqrt(1-hii)))
ri_1
Di_1 <- (1/p)*(ri_1^2)*(hii/(1-hii))
Di_1
ti_1 <- ri_1*(((n-p-1)/(n-p-(ri_1^2)))^0.5)
ti_1
qt(p = 0.975, df = 49, lower.tail = TRUE)
data(mantel)
X1 <- mantel$X1
X2 <- mantel$X2
X3 <- mantel$X3
Y <- mantel$Y
fullModel <- ~ X1 + X2 + X3
baseModel <- lm(Y ~ X1)
forward <- step(baseModel, fullModel, direction = 'forward')
save.image('HW7.RData')
load('HW7.RData')
library(car)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
influenceIndexPlot(fit2,id.n=2)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
influenceIndexPlot(fit2,n=2)
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
influenceIndexPlot(fit2)
save.image('HW7.RData')
new.lathe1 <- lathe1[-9,10]
new.lathe1 <- lathe1
View(new.lathe1)
View(new.lathe1)
new.lathe1 <- remove(pos = c(9, 10), envir = lathe1)
is.environment(lathe1)
new.lathe1 <- lathe1(-c(9, 10))
new.lathe1 <- lathe1[-c(9, 10)]
View(new.lathe1)
View(new.lathe1)
as.data.frame(lathe1)
new.lathe1 <- lathe1[-c(9, 10)]
View(lathe1)
View(lathe1)
View(new.lathe1)
View(new.lathe1)
as.data.frame(lathe1)
new.lathe1 <- lathe1[-c(9, 10), ]
View(new.lathe1)
View(new.lathe1)
new.lathe1 <- lathe1[-c(9, 10), ]
fit2 <- lm(log(Life) ~ Speed + Feed + I(Speed^2) + I(Feed^2) + Speed*Feed)
new.lathe1 <- lathe1[-c(9, 10), ]
new.Speed <- new.lathe1$Speed
new.Feed <- new.lathe1$Feed
new.Life <- new.lathe1$Life
fit3 <- lm(log(new.Life) ~ new.Speed + new.Feed + I(new.Speed^2) + I(new.Feed^2) + new.Speed*new.Feed)
new.lathe1 <- lathe1[-c(9, 10), ]
new.Speed <- new.lathe1$Speed
new.Feed <- new.lathe1$Feed
new.Life <- new.lathe1$Life
fit3 <- lm(log(new.Life) ~ new.Speed + new.Feed + I(new.Speed^2) + I(new.Feed^2) + new.Speed*new.Feed)
summary(fit3)
new.lathe1 <- lathe1[-c(9, 10), ]
new.Speed <- new.lathe1$Speed
new.Feed <- new.lathe1$Feed
new.Life <- new.lathe1$Life
fit3 <- lm(log(new.Life) ~ new.Speed + new.Feed + I(new.Speed^2) + I(new.Feed^2) + new.Speed*new.Feed)
influenceIndexPlot(fit3)
new.lathe1 <- lathe1[-c(9, 10), ]
new.Speed <- new.lathe1$Speed
new.Feed <- new.lathe1$Feed
new.Life <- new.lathe1$Life
fit3 <- lm(log(new.Life) ~ new.Speed + new.Feed + I(new.Speed^2) + I(new.Feed^2) + new.Speed*new.Feed)
summary(fit2, fit3)
new.lathe1 <- lathe1[-c(9, 10), ]
new.Speed <- new.lathe1$Speed
new.Feed <- new.lathe1$Feed
new.Life <- new.lathe1$Life
fit3 <- lm(log(new.Life) ~ new.Speed + new.Feed + I(new.Speed^2) + I(new.Feed^2) + new.Speed*new.Feed)
summary(fit2)
summary(fit3)
save.image('HW7.RData')
load('FinalProject.RData')
library(car)
setwd("~/Desktop/PSTAT 126/Final")
setwd("~/Desktop/PSTAT 126/Final Project")
library("alr4", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
library("faraway", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
outlierTest(final.fit)
influenceIndexPlot(final.fit)
Concrete <- read.table('Concrete.txt')
Concrete <- read.table('Concrete.txt')
Concrete <- read.table('Concrete.txt')
X1 <- Concrete$X1
X2 <- Concrete$X2
X3 <- Concrete$X3
X4 <- Concrete$X4
X5 <- Concrete$X5
X6 <- Concrete$X6
X7 <- Concrete$X7
X8 <- Concrete$X8
Y <- Concrete$Y
m0 <- lm(Y ~ X1)
full <- ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8
n <- length(Y)
fit6 <- step(m0, full, direction = 'forward', k = log(n))
m1<-update(m0,full)
fit7 <- step(m1, scope = c(lower= ~X1), direction = 'backward', k = log(n))
! [Alt text] (/Users/SethMarceno/Desktop/PSTAT 126/)
/Users/SethMarceno/Desktop/PSTAT 126/Final Project/finaltitle.jpg
(/Users/SethMarceno/Desktop/PSTAT 126/Final Project/finaltitle.jpg)
! [Welcome to our Project] (/Users/SethMarceno/Desktop/PSTAT 126/Final Project/finaltitle.jpg)
save.image('FinalProject.RData')
install.packages("cars")
install.packages("car")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("tibble", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("tidyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("tools", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("Rcpp", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("rmarkdown", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("knitr", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("readr", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("readxl", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("markdown", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("plyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("tidyverse", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
library("car", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
update.package(checkBuilt = TRUE)
version
install.packages("KernSmooth")
